(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[934],{495:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat/[id]",function(){return r(3720)}])},3720:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSP:function(){return U},default:function(){return D}});var s=r(828),l=r(5893),a=r(7294),i=r(1163),n=r(4661),o=r(2880),c=r(1799);function m(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}var d=r(5675),u=r.n(d),h=r(4803),f=r.n(h),x=function(e){var t,r=e.onClose,s=e.recipient,a=e.recipientEmail;return(0,l.jsxs)("div",{className:"relative bg-beige w-[25rem] max-h-screen min-h-screen flex flex-col items-center justify-start max-w-full text-left text-[1.25rem] text-darkolivegreen font-rubik",children:[(0,l.jsxs)("div",{className:"self-stretch bg-white h-[5.81rem] shrink-0 flex flex-row py-[2rem] px-[1.44rem] box-border items-center justify-start gap-[2.5rem]",children:[(0,l.jsx)(u(),{width:30,height:30,onClick:r,className:"relative cursor-pointer w-[1.88rem] h-[1.88rem] shrink-0 ",alt:"",loading:"lazy",src:"/frame5.svg"}),(0,l.jsx)("p",{className:"m-0 relative font-medium",children:"Contact info"})]}),(0,l.jsxs)("div",{className:"self-stretch flex-1 overflow-y-scroll flex flex-col py-[1.25rem] px-[0rem] items-center justify-start gap-[4.63rem] text-[1.75rem] text-gray-100",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center gap-[0.94rem]",children:[s?(0,l.jsx)(u(),{width:228,height:228,className:"relative rounded-[100000000376832px] w-[14.25rem] h-[14.25rem] shrink-0 object-cover",alt:"",loading:"lazy",src:null===s||void 0===s?void 0:s.photoURL}):(0,l.jsx)(u(),{width:228,height:228,className:"relative rounded-[100000000376832px] w-[14.25rem] h-[14.25rem] shrink-0 object-cover",alt:"",loading:"lazy",src:"https://res.cloudinary.com/dfk5jbk5r/image/upload/v1678095426/ChatFlame/Vector_10_ulkc6j.svg"}),s?(0,l.jsx)("p",{className:"m-0 relative font-medium",children:null===s||void 0===s?void 0:s.name}):(0,l.jsx)("p",{className:"m-0 relative font-medium",children:a}),s?(0,l.jsxs)("p",{className:"m-0 relative text-[1rem] text-gray-200",children:["last seen"," ",(0,l.jsx)(f(),{format:"LT",children:null===s||void 0===s||null===(t=s.lastSeen)||void 0===t?void 0:t.toDate()})]}):(0,l.jsx)("p",{className:"m-0 relative text-[1rem] text-gray-200",children:"last seen: unavailable"}),s?(0,l.jsx)("p",{className:"m-0 relative text-[1.25rem] text-gray-200",children:null===s||void 0===s?void 0:s.email}):""]}),(0,l.jsxs)("div",{className:"self-stretch bg-seagreen-200 flex flex-col p-[1.25rem] items-start justify-start gap-[0.63rem] text-[1.25rem]",children:[(0,l.jsx)("p",{className:"m-0 relative font-medium",children:"About"}),s?(0,l.jsx)("p",{className:"m-0 self-stretch relative text-[1rem]",children:null===s||void 0===s?void 0:s.about}):(0,l.jsx)("p",{className:"m-0 self-stretch relative text-[1rem]",children:"unavailable"})]})]})]})},v=r(6801),p=r(7896),j=r(3349),g=r(3653),b=r(6677),y=r(3247),w=function(e){var t,r,n,o=e.chatUsers,c=(0,s.Z)((0,j.F_)(g.I),1)[0],m=(0,i.useRouter)(),d=(0,y.IO)((0,y.hJ)(g.db,"users"),(0,y.ar)("email","==",(0,p.Z)(o,c))),h=(0,s.Z)((0,b.Kx)(d),1)[0],w=null===h||void 0===h||null===(t=h.docs)||void 0===t||null===(r=t[0])||void 0===r?void 0:r.data(),N=(0,p.Z)(o,c),k=(0,a.useState)(!1),_=k[0],C=k[1],O=(0,a.useCallback)((function(){C(!0)}),[]),S=(0,a.useCallback)((function(){C(!1)}),[]),Z=(0,a.useCallback)((function(){m.push("/")}),[m]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"self-stretch bg-white flex flex-row p-[0.94rem] items-center justify-center gap-[0.63rem] text-left text-[1rem] text-black font-rubik",children:[(0,l.jsx)("div",{className:"block lg:hidden",children:(0,l.jsx)(u(),{width:25,height:25,className:"relative w-[2.31rem] h-[2.31rem] shrink-0 cursor-pointer",alt:"",loading:"lazy",src:"/frame1.svg",onClick:Z})}),w?(0,l.jsx)(u(),{width:55,height:55,className:"relative rounded-large w-[3.44rem] h-[3.44rem] shrink-0 object-cover",alt:"",loading:"lazy",src:null===w||void 0===w?void 0:w.photoURL}):(0,l.jsx)(u(),{width:55,height:55,className:"relative rounded-large w-[3.44rem] h-[3.44rem] shrink-0 object-cover",alt:"",loading:"lazy",src:"https://res.cloudinary.com/dfk5jbk5r/image/upload/v1678095426/ChatFlame/Vector_10_ulkc6j.svg"}),(0,l.jsxs)("div",{className:"flex-1 flex flex-col p-[0.63rem] items-start justify-center gap-[0.63rem]",children:[w?(0,l.jsx)("p",{className:"m-0 relative font-medium",children:null===w||void 0===w?void 0:w.name}):(0,l.jsx)("p",{className:"m-0 relative font-medium",children:N}),w?(0,l.jsxs)("p",{className:"m-0 relative text-[0.75rem] text-gray-200",children:["last seen"," ",(0,l.jsx)(f(),{format:"LT",children:null===w||void 0===w||null===(n=w.lastSeen)||void 0===n?void 0:n.toDate()})]}):(0,l.jsx)("p",{className:"m-0 relative text-[0.75rem] text-gray-200",children:"last seen: unavailable"})]}),(0,l.jsx)("div",{className:" flex flex-col p-[0.63rem] items-center justify-center cursor-pointer",onClick:O,children:(0,l.jsx)(u(),{width:24,height:24,className:"relative w-[1.5rem] h-[1.5rem] shrink-0 ",alt:"",loading:"lazy",src:"/frame11.svg"})})]}),_&&(0,l.jsx)(v.Z,{overlayColor:"rgba(113, 113, 113, 0.3)",placement:"Top right",onOutsideClick:S,children:(0,l.jsx)(x,{onClose:S,recipient:w,recipientEmail:N})})]})},N=function(e){var t=e.message;return(0,l.jsxs)("div",{className:"self-stretch flex flex-row py-[0.63rem] px-[0rem] items-start justify-start gap-[0.63rem] text-left text-[0.75rem] text-gray-100 font-rubik",children:[(0,l.jsx)(u(),{width:35,height:35,className:"relative rounded-base w-[2.19rem] h-[2.19rem] shrink-0 object-cover",alt:"",src:null===t||void 0===t?void 0:t.photoURL}),(0,l.jsxs)("div",{className:" flex flex-col items-start justify-start",children:[(0,l.jsx)("div",{className:"self-stretch flex flex-row py-[0.63rem] px-[0.25rem] items-center justify-end",children:(0,l.jsx)("p",{className:"m-0 relative text-[0.63rem] text-gray-200",children:(0,l.jsx)(f(),{format:"h:mm A",children:null===t||void 0===t?void 0:t.timestamp})})}),(0,l.jsxs)("div",{className:"rounded-tl-none rounded-tr-lg rounded-b-lg bg-seagreen-200 flex flex-col p-[0.63rem] items-start justify-start text-[14px] text-darkolivegreen",children:[(null===t||void 0===t?void 0:t.messageImage)&&(0,l.jsx)("div",{className:"mb-5 w-80 h-80 relative rounded-lg ",children:(0,l.jsx)(u(),{layout:"fill",objectFit:"cover",className:"rounded-lg shrink-0 object-cover",alt:"",src:null===t||void 0===t?void 0:t.messageImage})}),(0,l.jsx)("p",{className:"m-0 relative",children:null===t||void 0===t?void 0:t.message})]})]})]})},k=function(e){var t=e.message;return(0,l.jsxs)("div",{className:"self-stretch flex flex-row py-[0.63rem] px-[0rem] items-start justify-end gap-[0.63rem] text-left text-[0.63rem] text-gray-200 font-rubik",children:[(0,l.jsxs)("div",{className:" flex flex-col items-start justify-start",children:[(0,l.jsx)("div",{className:"self-stretch flex flex-row py-[0.63rem] px-[0.25rem] items-center justify-between",children:(0,l.jsx)("p",{className:"m-0 relative",children:(0,l.jsx)(f(),{format:"h:mm A",children:null===t||void 0===t?void 0:t.timestamp})})}),(0,l.jsxs)("div",{className:"rounded-tl-lg rounded-tr-none rounded-b-lg bg-darkolivegreen flex flex-col p-[0.63rem] items-start text-[14px] justify-start text-white",children:[(null===t||void 0===t?void 0:t.messageImage)&&(0,l.jsx)("div",{className:"mb-5 w-80 h-80 relative rounded-lg ",children:(0,l.jsx)(u(),{layout:"fill",objectFit:"cover",className:"rounded-lg shrink-0 object-cover",alt:"",src:null===t||void 0===t?void 0:t.messageImage})}),(0,l.jsx)("p",{className:"m-0 relative",children:null===t||void 0===t?void 0:t.message})]})]}),(0,l.jsx)(u(),{width:35,height:35,className:"relative rounded-base w-[2.19rem] h-[2.19rem] shrink-0 object-cover",alt:"",loading:"lazy",src:null===t||void 0===t?void 0:t.photoURL})]})},_=r(7568),C=r(943);var O=r(3375);var S=r(1566);function Z(e){return function(e){if(Array.isArray(e))return(0,C.Z)(e)}(e)||(0,O.Z)(e)||(0,S.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var E=r(655),I=r(6431);function F(e){const t=(0,a.useRef)(null),r=(0,a.useRef)(null);return r.current&&r.current.update(e),(0,a.useEffect)((()=>(r.current=new(0,I.cW)({...e,ref:t}),()=>{r.current=null})),[]),a.createElement("div",{ref:t})}var R=function(e){var t=e.ScrollToBottom,r=(0,s.Z)((0,j.F_)(g.I),1)[0],n=(0,a.useState)(""),o=n[0],c=n[1],m=(0,a.useState)(null),d=m[0],h=m[1],f=(0,a.useState)(!1),x=f[0],v=f[1],p=(0,i.useRouter)(),b=function(){var e=(0,_.Z)((function(e){return(0,E.__generator)(this,(function(s){switch(s.label){case 0:return e.preventDefault(),[4,(0,y.pl)((0,y.JU)(g.db,"users",r.uid),{lastSeen:(0,y.Bt)()},{merge:!0})];case 1:return s.sent(),(0,y.ET)((0,y.hJ)((0,y.JU)(g.db,"chats",p.query.id),"messages"),{timestamp:(0,y.Bt)(),message:o,messageImage:d,user:r.email,photoURL:r.photoURL}),c(""),h(null),t(),[2]}}))}));return function(t){return e.apply(this,arguments)}}();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"self-stretch rounded-xxs bg-seagreen-100 flex flex-row p-[0.94rem] items-center justify-start gap-[0.63rem]",children:[(0,l.jsx)("input",{value:o,onChange:function(e){return c(e.target.value)},className:"[border:none] outline-none font-rubik text-[0.75rem] bg-[transparent] self-stretch flex-1 flex flex-row items-center justify-start",type:"text",placeholder:"Your Message"}),(0,l.jsx)("div",{children:d&&(0,l.jsx)(u(),{onClick:function(){return h(null)},src:d,width:50,height:40,className:"rounded-md cursor-pointer"})}),(0,l.jsxs)("div",{className:" flex flex-row items-center justify-center gap-[0.63rem]",children:[(0,l.jsx)(u(),{onClick:function(){return v(!x)},width:20,height:20,className:"relative w-[1.25rem] h-[1.25rem] shrink-0 ",alt:"",loading:"lazy",src:"/frame12.svg"}),(0,l.jsx)("label",{htmlFor:"file",children:(0,l.jsx)(u(),{width:20,height:20,className:"relative w-[1.25rem] h-[1.25rem] shrink-0 ",alt:"",loading:"lazy",src:"/frame13.svg"})}),(0,l.jsx)("input",{id:"file",type:"file",onChange:function(e){var t=new FormData;t.append("file",e.target.files[0]),t.append("upload_preset","ugfxe2q8"),t.append("cloud_name","dfk5jbk5r"),fetch("https://api.cloudinary.com/v1_1/dfk5jbk5r/image/upload",{method:"post",body:t}).then((function(e){return e.json()})).then((function(e){h(e.url)})).catch((function(e){return console.log(e)}))},className:"hidden"}),(0,l.jsx)("button",{className:"bg-transparent outline-none border-none ",disabled:!o,type:"submit",onClick:b,children:(0,l.jsx)(u(),{width:24,height:24,className:"relative w-[1.5rem] h-[1.5rem] shrink-0 ",alt:"",loading:"lazy",src:"/frame14.svg"})})]})]}),x&&(0,l.jsx)("div",{className:"absolute bottom-20 right-5",children:(0,l.jsx)(F,{onEmojiSelect:function(e){var t,r=e.unified.split("-"),s=[];r.forEach((function(e){return s.push("0x"+e)}));var l=(t=String).fromCodePoint.apply(t,Z(s));c(o+l)},theme:"light"})})]})},P=function(e){var t=e.chat,r=e.messages,n=(0,s.Z)((0,j.F_)(g.I),1)[0],o=(0,i.useRouter)(),d=(0,a.useRef)(null),u=(0,y.IO)((0,y.hJ)((0,y.JU)(g.db,"chats",o.query.id),"messages"),(0,y.Xo)("timestamp","asc")),h=(0,s.Z)((0,b.Kx)(u),1)[0];return(0,l.jsxs)("div",{className:"h-screen self-stretch flex-1 bg-beige overflow-y-scroll flex flex-col items-start justify-start text-left text-[1rem] text-black font-rubik",children:[(0,l.jsx)(w,{chatUsers:null===t||void 0===t?void 0:t.users}),(0,l.jsxs)("div",{className:"h-full relative self-stretch flex-1 overflow-y-scroll flex flex-col px-[0.94rem] pb-[0.94rem] items-start justify-start text-[0.75rem] text-gray-100",children:[(0,l.jsx)("div",{ref:d,className:"self-stretch flex-1 overflow-y-scroll flex flex-col items-start justify-start gap-[0.63rem]",children:h?h.docs.map((function(e){var t,r;return e.data().user===n.email?(0,l.jsx)(k,{message:m((0,c.Z)({},e.data()),{timestamp:null===(t=e.data().timestamp)||void 0===t?void 0:t.toDate().getTime()})},e.id):(0,l.jsx)(N,{message:m((0,c.Z)({},e.data()),{timestamp:null===(r=e.data().timestamp)||void 0===r?void 0:r.toDate().getTime()})},e.id)})):JSON.parse(r).map((function(e){return e.user===n.email?(0,l.jsx)(k,{message:e},e.id):(0,l.jsx)(N,{message:e},e.id)}))}),(0,l.jsx)(R,{ScrollToBottom:function(){d.current.scrollIntoView({behavior:"smooth",block:"start"})}})]})]})},z=r(9008),T=r.n(z),U=!0,D=function(e){var t=e.messages,r=e.chat;(0,s.Z)((0,j.F_)(g.I),1)[0],(0,i.useRouter)();return(0,l.jsxs)("div",{className:"max-w-[110rem] mx-auto bg-white w-full max-h-screen flex flex-row items-start justify-center",children:[(0,l.jsx)(T(),{children:(0,l.jsx)("title",{children:"ChatFlame"})}),(0,l.jsx)(n.Z,{}),(0,l.jsx)(o.Z,{w:"hid"}),(0,l.jsx)(P,{chat:r,messages:t})]})}}},function(e){e.O(0,[885,510,717,21,774,888,179],(function(){return t=495,e(e.s=t);var t}));var t=e.O();_N_E=t}]);